# URL Shortener System

A modern Java web application for shortening URLs built with Jakarta EE and PostgreSQL.

## Features

- ðŸ”— **URL Shortening**: Convert long URLs into short, shareable links
- ðŸ“Š **Click Tracking**: Monitor how many times each link is accessed
- âš¡ **Fast Redirects**: Instant redirection to original URLs
- ðŸŽ¨ **Modern UI**: Clean, responsive Bootstrap-based interface
- ðŸ”’ **Secure**: Safe URL validation and secure random code generation

## Technology Stack

- **Backend**: Java 17, Jakarta EE 8
- **Frontend**: JSP, SCSS, CSS3, JavaScript
- **Database**: PostgreSQL 42.6.0
- **ORM**: Hibernate 5.6.15
- **Application Server**: WildFly 26.1.3
- **Build Tool**: Maven 3.11.0
- **CSS Preprocessor**: Sass (via Node.js)

## Project Structure

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/com/urlshortener/
â”‚   â”‚   â”œâ”€â”€ model/          # JPA entities (UrlMapping)
â”‚   â”‚   â”œâ”€â”€ service/        # Business logic (UrlService)
â”‚   â”‚   â”œâ”€â”€ servlet/        # Web controllers (ShortenUrlServlet, RedirectServlet)
â”‚   â”‚   â””â”€â”€ util/           # Utility classes (ShortCodeGenerator)
â”‚   â”œâ”€â”€ resources/
â”‚   â”‚   â””â”€â”€ META-INF/       # JPA configuration (persistence.xml)
â”‚   â””â”€â”€ webapp/
â”‚       â”œâ”€â”€ styles/         # SCSS source files and compiled CSS
â”‚       â”‚   â”œâ”€â”€ style.scss  # Main stylesheet
â”‚       â”‚   â”œâ”€â”€ style.css   # Compiled CSS
â”‚       â”‚   â”œâ”€â”€ _variables.scss
â”‚       â”‚   â””â”€â”€ _mixins.scss
â”‚       â”œâ”€â”€ index.jsp       # Main application page
â”‚       â””â”€â”€ WEB-INF/        # Web configuration (web.xml, beans.xml)
â”œâ”€â”€ target/                 # Maven build output
â”œâ”€â”€ pom.xml                # Maven configuration
â”œâ”€â”€ package.json           # Node.js dependencies for SCSS compilation
â””â”€â”€ configure-postgresql.sh # Database setup script
```

## Quick Start

1. **Prerequisites**:

   - Java 17 or higher
   - PostgreSQL database server
   - WildFly 26.1.3 Final application server
   - Maven 3.6+ (for building)
   - Node.js (for SCSS compilation)

2. **Database Setup**:

   ```sql
   CREATE DATABASE url_mappings;
   CREATE USER url_app WITH PASSWORD 'urlpass123';
   GRANT ALL PRIVILEGES ON DATABASE url_mappings TO url_app;
   ```

3. **Configure WildFly DataSource**:

   - Add PostgreSQL driver module to WildFly
   - Configure datasource with JNDI name: `java:jboss/datasources/UrlShortenerDS`
   - See `configure-postgresql.sh` for automated setup commands

4. **Build and Deploy**:

   ```bash
   # Install Node.js dependencies for SCSS compilation
   npm install

   # Compile SCSS to CSS (if changes were made)
   npm run sass

   # Build WAR file
   mvn clean package

   # Deploy to WildFly
   # Copy target/url-shortener.war to WildFly deployments directory
   ```

5. **Access**:
   - Open browser to `http://localhost:8080/url-shortener`

## API Endpoints

- `GET /` - Main page with URL shortening form (index.jsp)
- `POST /shorten` - Create a short URL (ShortenUrlServlet)
- `GET /r/{shortCode}` - Redirect to original URL (RedirectServlet)

## Database Schema

```sql
CREATE TABLE url_mappings (
    id BIGSERIAL PRIMARY KEY,
    original_url VARCHAR(2048) NOT NULL,
    short_code VARCHAR(10) NOT NULL UNIQUE,
    created_at TIMESTAMP NOT NULL,
    click_count BIGINT NOT NULL DEFAULT 0
);

-- Example data
INSERT INTO url_mappings (original_url, short_code, created_at, click_count)
VALUES ('https://www.postgresql.org', 'mzy3SQ', NOW(), 1);
```

## Development Notes

- Short codes are 6 characters long using alphanumeric characters
- URLs are automatically prefixed with `https://` if no protocol is specified
- Duplicate URLs return the existing short code
- Click counts are tracked for analytics
- SCSS files are automatically compiled to CSS during Maven build
- Application uses Jakarta EE 8 (javax namespace) for compatibility with WildFly
- Database schema is auto-generated by Hibernate

## Build Process

The project uses a modern build process that includes:

1. **Java Compilation**: Maven compiles Java sources with Java 17
2. **SCSS Compilation**: Node.js/Sass compiles SCSS to CSS during Maven build
3. **WAR Packaging**: All resources are packaged into `target/url-shortener.war`

### Manual SCSS Compilation

```bash
npm install
npm run sass
```

## Author

Andrii Opanasenko - 2025

## Configuration Files

### Maven Configuration (pom.xml)

- **Java Version**: 17
- **Jakarta EE**: 8.0.0 (javax namespace)
- **Hibernate**: 5.6.15.Final
- **PostgreSQL Driver**: 42.6.0
- **Frontend Maven Plugin**: Handles Node.js and SCSS compilation

### Persistence Configuration (persistence.xml)

- **Persistence Unit**: `urlShortenerPU`
- **JTA DataSource**: `java:jboss/datasources/UrlShortenerDS`
- **Hibernate Dialect**: PostgreSQLDialect
- **Schema Generation**: Auto-update

### Web Configuration (web.xml)

- **Version**: 3.1 (Jakarta EE 8 compatible)
- **Welcome File**: index.jsp
- **Servlet Mappings**: Annotation-based (@WebServlet)

## Deployment Structure

```
wildfly/standalone/deployments/
â””â”€â”€ url-shortener.war
    â”œâ”€â”€ WEB-INF/
    â”‚   â”œâ”€â”€ classes/
    â”‚   â”‚   â”œâ”€â”€ com/urlshortener/          # Compiled Java classes
    â”‚   â”‚   â””â”€â”€ META-INF/persistence.xml   # JPA configuration
    â”‚   â”œâ”€â”€ web.xml                        # Web configuration
    â”‚   â””â”€â”€ beans.xml                      # CDI configuration
    â”œâ”€â”€ styles/style.css                   # Compiled CSS
    â””â”€â”€ index.jsp                          # Main page
```

## Project Features

- âœ… **Clean Architecture**: Organized packages with clear separation of concerns
- âœ… **Modern CSS**: SCSS with variables, mixins, and responsive design
- âœ… **Centered UI**: Flexbox-based layout with perfect vertical/horizontal centering
- âœ… **Database Integration**: PostgreSQL with Hibernate ORM
- âœ… **JEE Standards**: Uses Jakarta EE specifications
- âœ… **Build Automation**: Maven with integrated SCSS compilation
- âœ… **Production Ready**: Optimized for WildFly deployment
